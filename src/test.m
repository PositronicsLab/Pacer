function test
format short
%% stage 1
G = [ %20x20
1.9168385 1.91683875 -5.14304686e-09 -7.92050597e-08 -1.67590718 -1.67590667 1.67590718 1.67590667 -1.64552341 -1.70629043 1.64552341 1.70629043 3.6911015e-06 -3.62963143e-06 -3.6911015e-06 3.62963143e-06 0.0159132994 -0.0159133049 -0.0159132994 0.0159133049 ;
1.91683875 1.916839 -5.09784465e-09 -7.92051385e-08 -1.67590738 -1.67590691 1.67590738 1.67590691 -1.64552365 -1.70629063 1.64552365 1.70629063 3.71942937e-06 -3.6585032e-06 -3.71942937e-06 3.6585032e-06 0.0159133152 -0.0159133207 -0.0159133152 0.0159133207 ;
-5.14304686e-09 -5.09784465e-09 0.000116786386 -2.07161419e-16 1.01619701e-05 -1.01530594e-05 -1.01619701e-05 1.01530594e-05 4.37558049e-09 4.53858919e-09 -4.37558049e-09 -4.53858919e-09 -0.000142942382 -0.00125792162 0.000142942382 0.00125792162 3.12047181e-11 -3.12048361e-11 -3.12047181e-11 3.12048361e-11 ;
-7.92050597e-08 -7.92051385e-08 -2.07161419e-16 8.04799597e-12 6.92496729e-08 6.92495364e-08 -6.92496729e-08 -6.92495364e-08 8.33635845e-08 5.51356189e-08 -8.33635845e-08 -5.51356189e-08 -3.83102413e-13 3.85610361e-13 3.83102413e-13 -3.85610361e-13 -1.61694431e-06 1.61694488e-06 1.61694431e-06 -1.61694488e-06 ;
-1.67590718 -1.67590738 1.01619701e-05 6.92496729e-08 1.46954506 1.46097247 -1.46954506 -1.46097247 1.43869422 1.4918233 -1.43869422 -1.4918233 0.00636217707 -0.00648445368 -0.00636217707 0.00648445368 -0.0139131362 0.013913141 0.0139131362 -0.013913141 ;
-1.67590667 -1.67590691 -1.01530594e-05 6.92495364e-08 1.46097247 1.46954424 -1.46097247 -1.46954424 1.43869382 1.49182289 -1.43869382 -1.49182289 -0.00636868313 0.00649085325 0.00636868313 -0.00649085325 -0.0139131086 0.0139131135 0.0139131086 -0.0139131135 ;
1.67590718 1.67590738 -1.01619701e-05 -6.92496729e-08 -1.46954506 -1.46097247 1.46954506 1.46097247 -1.43869422 -1.4918233 1.43869422 1.4918233 -0.00636217707 0.00648445368 0.00636217707 -0.00648445368 0.0139131362 -0.013913141 -0.0139131362 0.013913141 ;
1.67590667 1.67590691 1.01530594e-05 -6.92495364e-08 -1.46097247 -1.46954424 1.46097247 1.46954424 -1.43869382 -1.49182289 1.43869382 1.49182289 0.00636868313 -0.00649085325 -0.00636868313 0.00649085325 0.0139131086 -0.0139131135 -0.0139131086 0.0139131135 ;
-1.64552341 -1.64552365 4.37558049e-09 8.33635845e-08 1.43869422 1.43869382 -1.43869422 -1.43869382 1.41680944 1.46057859 -1.41680944 -1.46057859 -3.19340787e-06 3.1411138e-06 3.19340787e-06 -3.1411138e-06 -0.0167487997 0.0167488055 0.0167487997 -0.0167488055 ;
-1.70629043 -1.70629063 4.53858919e-09 5.51356189e-08 1.4918233 1.49182289 -1.4918233 -1.49182289 1.46057859 1.52306759 -1.46057859 -1.52306759 -3.31044375e-06 3.25620139e-06 3.31044375e-06 -3.25620139e-06 -0.0110774439 0.0110774478 0.0110774439 -0.0110774478 ;
1.64552341 1.64552365 -4.37558049e-09 -8.33635845e-08 -1.43869422 -1.43869382 1.43869422 1.43869382 -1.41680944 -1.46057859 1.41680944 1.46057859 3.19340787e-06 -3.1411138e-06 -3.19340787e-06 3.1411138e-06 0.0167487997 -0.0167488055 -0.0167487997 0.0167488055 ;
1.70629043 1.70629063 -4.53858919e-09 -5.51356189e-08 -1.4918233 -1.49182289 1.4918233 1.49182289 -1.46057859 -1.52306759 1.46057859 1.52306759 3.31044375e-06 -3.25620139e-06 -3.31044375e-06 3.25620139e-06 0.0110774439 -0.0110774478 -0.0110774439 0.0110774478 ;
3.6911015e-06 3.71942937e-06 -0.000142942382 -3.83102413e-13 0.00636217707 -0.00636868313 -0.00636217707 0.00636868313 -3.19340787e-06 -3.31044375e-06 3.19340787e-06 3.31044375e-06 0.35021055 -0.348516962 -0.35021055 0.348516962 7.69551016e-08 -7.69551168e-08 -7.69551016e-08 7.69551168e-08 ;
-3.62963143e-06 -3.6585032e-06 -0.00125792162 3.85610361e-13 -0.00648445368 0.00649085325 0.00648445368 -0.00649085325 3.1411138e-06 3.25620139e-06 -3.1411138e-06 -3.25620139e-06 -0.348516962 0.363626875 0.348516962 -0.363626875 -7.73340299e-08 7.73340465e-08 7.73340299e-08 -7.73340465e-08 ;
-3.6911015e-06 -3.71942937e-06 0.000142942382 3.83102413e-13 -0.00636217707 0.00636868313 0.00636217707 -0.00636868313 3.19340787e-06 3.31044375e-06 -3.19340787e-06 -3.31044375e-06 -0.35021055 0.348516962 0.35021055 -0.348516962 -7.69551016e-08 7.69551168e-08 7.69551016e-08 -7.69551168e-08 ;
3.62963143e-06 3.6585032e-06 0.00125792162 -3.85610361e-13 0.00648445368 -0.00649085325 -0.00648445368 0.00649085325 -3.1411138e-06 -3.25620139e-06 3.1411138e-06 3.25620139e-06 0.348516962 -0.363626875 -0.348516962 0.363626875 7.73340299e-08 -7.73340465e-08 -7.73340299e-08 7.73340465e-08 ;
0.0159132994 0.0159133152 3.12047181e-11 -1.61694431e-06 -0.0139131362 -0.0139131086 0.0139131362 0.0139131086 -0.0167487997 -0.0110774439 0.0167487997 0.0110774439 7.69551016e-08 -7.73340299e-08 -7.69551016e-08 7.73340299e-08 0.324864591 -0.324864703 -0.324864591 0.324864703 ;
-0.0159133049 -0.0159133207 -3.12048361e-11 1.61694488e-06 0.013913141 0.0139131135 -0.013913141 -0.0139131135 0.0167488055 0.0110774478 -0.0167488055 -0.0110774478 -7.69551168e-08 7.73340465e-08 7.69551168e-08 -7.73340465e-08 -0.324864703 0.324864816 0.324864703 -0.324864816 ;
-0.0159132994 -0.0159133152 -3.12047181e-11 1.61694431e-06 0.0139131362 0.0139131086 -0.0139131362 -0.0139131086 0.0167487997 0.0110774439 -0.0167487997 -0.0110774439 -7.69551016e-08 7.73340299e-08 7.69551016e-08 -7.73340299e-08 -0.324864591 0.324864703 0.324864591 -0.324864703 ;
0.0159133049 0.0159133207 3.12048361e-11 -1.61694488e-06 -0.013913141 -0.0139131135 0.013913141 0.0139131135 -0.0167488055 -0.0110774478 0.0167488055 0.0110774478 7.69551168e-08 -7.73340465e-08 -7.69551168e-08 7.73340465e-08 0.324864703 -0.324864816 -0.324864703 0.324864816 ];

c = [ %20
2.16910749e-05 2.16910957e-05 4.70292927e-08 1.23302236e-09 -1.92880628e-05 -1.86412883e-05 1.92880628e-05 1.86412883e-05 -2.29818458e-05 -1.49475037e-05 2.29818458e-05 1.49475037e-05 -1.7133118e-05 1.65700225e-05 1.7133118e-05 -1.65700225e-05 -0.000247729809 0.000247729895 0.000247729809 -0.000247729895 ]';

A = [ %8x20
1.9168385 1.91683875 -5.1430468e-09 -7.92050597e-08 -1.67590718 -1.67590667 1.67590718 1.67590667 -1.64552341 -1.70629043 1.64552341 1.70629043 3.6911015e-06 -3.62963143e-06 -3.6911015e-06 3.62963143e-06 0.0159132994 -0.0159133049 -0.0159132994 0.0159133049 ;
1.91683875 1.916839 -5.09784459e-09 -7.92051385e-08 -1.67590738 -1.67590691 1.67590738 1.67590691 -1.64552365 -1.70629063 1.64552365 1.70629063 3.71942937e-06 -3.6585032e-06 -3.71942937e-06 3.6585032e-06 0.0159133152 -0.0159133207 -0.0159133152 0.0159133207 ;
-5.14304774e-09 -5.09784553e-09 0.000116786386 -2.07161875e-16 1.01619701e-05 -1.01530594e-05 -1.01619701e-05 1.01530594e-05 4.37558123e-09 4.53858998e-09 -4.37558123e-09 -4.53858998e-09 -0.000142942382 -0.00125792162 0.000142942382 0.00125792162 3.12048097e-11 -3.12049276e-11 -3.12048097e-11 3.12049276e-11 ;
-7.92050587e-08 -7.92051376e-08 -1.55315357e-16 8.04799597e-12 6.92496725e-08 6.92495352e-08 -6.92496725e-08 -6.92495352e-08 8.33635837e-08 5.51356181e-08 -8.33635837e-08 -5.51356181e-08 -3.8302757e-13 3.84913612e-13 3.8302757e-13 -3.84913612e-13 -1.61694431e-06 1.61694488e-06 1.61694431e-06 -1.61694488e-06 ;
0.353553391 0 0 0 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 0 0 0 ;
0 0.353553391 0 0 0 0 0 0 -1 -1 -1 -1 0 0 0 0 0 0 0 0 ;
0 0 0.353553391 0 0 0 0 0 0 0 0 0 -1 -1 -1 -1 0 0 0 0 ;
0 0 0 0.353553391 0 0 0 0 0 0 0 0 0 0 0 0 -1 -1 -1 -1 ];

b = [ %8
-1.11773683e-08 -6.09839961e-09 6.17576233e-09 -5.3304256e-09 0 0 0 0 ]';

%% stage 2
format long E
svd(G)
format short


% linprog(ones(size(A,2),1),[eye(4,size(A,2));A],[zeros(4,1);b])
% linprog(ones(size(A,2),1),A,b)
linprog(ones(size(A,2),1),-A,-b,[],[],zeros(size(A,2),1))
exitflag = -1;
options = optimoptions(@quadprog,'Algorithm','interior-point-convex');
x = []; i = -11;
while (exitflag < 0)
    i = i +1
    [x,fval,exitflag,output,lambda] = quadprog(G,c,-A,-b,zeros(0,size(c,1)),[],zeros(size(A,2),1),[],zeros(size(c)),options);
    G = G+ eye(size(G))*1*10^i;
end
x
end
